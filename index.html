<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tsunami Of The World</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-cloud/1.2.5/d3.layout.cloud.js"></script>

    <!-- CSS file -->
    <link rel="stylesheet" type="text/css" href="styles.css" media="all">


</head>
<body>
    <!-- Choropleth Map Container -->
    <div id="choropleth_map"></div>

    <!-- <div id="boxplot"></div> -->

    <div id="top10_boxplot"></div>

    <div id="selected_country_boxplot"></div>

    <div id="horizontal_bar"></div>

    <div id="word_cloud"></div>

    <svg id="word-cloud" width="800" height="400"></svg>  

    <script type="text/javascript">

      var spec1 = "js/choropleth_map.json";
      vegaEmbed('#choropleth_map', spec1).then(function(result) {
        // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
      }).catch(console.error);

      // var spec2 = "js/boxplot.json";
      // vegaEmbed('#boxplot', spec2).then(function(result) {
      //   // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
      // }).catch(console.error);

      var spec3 = "js/top10_boxplot.json";
      vegaEmbed('#top10_boxplot', spec3).then(function(result) {
        // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
      }).catch(console.error);

      var spec4 = "js/selected_country_boxplot.json";
      vegaEmbed('#selected_country_boxplot', spec4).then(function(result) {
        // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
      }).catch(console.error);

      var spec5 = "js/horizontal_bar.json";
      vegaEmbed('#horizontal_bar', spec5).then(function(result) {
        // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
      }).catch(console.error);

      // var spec6 = "js/word_cloud.json";
      // vegaEmbed('#word_cloud', spec6).then(function(result) {
      //   // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
      // }).catch(console.error);

      // word-cloud.js
      d3.json('https://raw.githubusercontent.com/Szeyuinn/FIT3179Assignment/refs/heads/main/cleaned_causes.json').then(function(data) {
        const width = 800;
        const height = 400;

        // Create a scale for font sizes (slightly reduced maximum size)
        const fontSizeScale = d3.scaleLinear()
            .domain([d3.min(data, d => d.size), d3.max(data, d => d.size)])
            .range([10, 80]); // Adjusted range to better handle large words

        // Create the layout for the word cloud
        const layout = d3.layout.cloud()
            .size([width, height])
            .words(data.map(d => ({ text: d.text, size: fontSizeScale(d.size) })))
            .padding(5)  // Adjust padding to better fit words
            .rotate(() => Math.random() > 0.5 ? 0 : 90) // Randomly rotate words by 0 or 90 degrees
            .fontSize(d => d.size)
            .on("end", draw);

        // Start the layout
        layout.start();

        // Draw the word cloud
        function draw(words) {
            d3.select("#word_cloud").selectAll("*").remove(); // Clear previous content

            const svg = d3.select("#word_cloud")
                .append("svg")
                .attr("width", width)
                .attr("height", height)
                .append("g")
                .attr("transform", `translate(${width / 2}, ${height / 2})`);

            const wordElements = svg.selectAll("text")
                .data(words)
                .enter().append("text")
                .style("font-size", d => d.size + "px")
                .style("fill", (d, i) => d3.schemeCategory10[i % 10]) // Use a color scheme
                .attr("text-anchor", "middle")
                .attr("transform", d => `translate(${d.x}, ${d.y}) rotate(${d.rotate})`)
                .text(d => d.text);

            // Add tooltips on hover
            wordElements
                .on("mouseover", function(event, d) {
                    d3.select(this)
                        .style("cursor", "pointer")
                        .append("title")
                        .text(`Cause: ${d.text}, Size: ${d.size}`);
                })
                .on("mouseout", function() {
                    d3.select(this).select("title").remove();
                });
        }
    }).catch(function(error) {
        console.error('Error loading the data:', error);
    });


    </script>

</body>
</html>
